

@import 'partials/SassyLists';


$brick_bg:lightSlateGray;

// list of items with image backgrounds
$furniture_items: couch, box, table, chair-left, chair-right, beds-left, beds-right; 

// brick size
$brick_wh: 34px;

$box_bg_positions: 0px 0px, 0px -34px, -34px -34px, -34px 0px;
$box_bg_position_refs: 1, 4, 2, 3;

$couch_bg_positions_180_deg:  -272px 0px, -238px 0px, -204px 0px, -170px 0px, ;

@function set_bg_position_initial($piece, $slice) {

  $xpos:'';
  $ypos:'';

  @if $piece == couch {
    $xpos: -$brick_wh*( 5 + $slice ); 
    $ypos:  0px;
  } 
  @else if $piece == box {
    @if $slice < 2 {
      $xpos: -$brick_wh*($slice);
      $ypos: 0px;
    } @else {
      $xpos: -$brick_wh*( $slice - 2 );
      $ypos: -$brick_wh;
    } 
  }

  @return $xpos $ypos;

}

@function set_bg_pos_rotate($piece, $slice, $rotation, $bg_coords, $shifted_bg_list) {

  @if $piece == couch {

    @if ( $rotation == 3  or $rotation == 0 ) {

      @return nth($shifted_bg_list, $slice + 1);
    
    } @else {

      @return $bg_coords;

    }

  } @else if $piece == box {

      @return nth($shifted_bg_list, $rotation + 1);
  }
  @return "";
}

@function set_transform_val($piece, $rotation){

  $transform_val:'';
  @if $piece == couch or $piece == table { 
    $transform_val: rotate( 90deg*($rotation - 1) ); 
  }
  @else { $transform_val: rotate( 90deg*($rotation) ); }
  //@if ( $rotation == 2 and not ( $piece == couch or $piece == box ) ) or ( ($rotation == 3 and $piece == couch) or ($rotation == 0 and $piece == couch) ) { $transform_val: $transform_val + ' ' + scaleX(-1); }

  @return $transform_val;

}

.single-brick {
  background-color: $brick_bg;
  position: absolute;
  width: $brick_wh;
  height: $brick_wh;
}

@each $item in $furniture_items {
  
  @for $slice from 0 through 3 {

    $tmp_list:();
    $shape_positions:(1,2,3,4);
    $shape_ref_array:(1,2,3,4);

    .icon-sprite-#{$item}-#{$slice}{

      background-image: url('../img/spritesheet.png');

      $bg_pos: set_bg_position_initial($item, $slice);

      //.debug-#{$i}{ background: $tmp_list;}

      @if ( $item == box ) {
        $shape_positions: $box_bg_positions;
        $shape_ref_array: $box_bg_position_refs;
     }

     $tmp_list: join(slice($shape_positions, nth($shape_ref_array, $slice + 1)), slice($shape_positions, 1, nth($shape_ref_array, $slice+ 1)));

     @if ( $item == couch ) {
      $tmp_list: $couch_bg_positions_180_deg; 
     }

     //.debug-#{$item}-#{$slice} { background: $tmp_list;}

      @for $rotation from 0 through 3{
        &.rot-#{$rotation}{
          //$bg_pos_val: nth($tmp_list, $j + 1);
          transform: set_transform_val($item, $rotation);
          background-position: set_bg_pos_rotate($item, $slice, $rotation, $bg_pos, $tmp_list); //$xpos $ypos;
        }
      }
    }
  }
}
